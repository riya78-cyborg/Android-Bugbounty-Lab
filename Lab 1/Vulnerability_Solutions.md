# QuickPay Lab - Vulnerability Solutions

This document contains solutions and explanations for the QuickPay Android Bug Bounty Lab.

---

## 1. Hardcoded Stripe API Keys (Critical)

- **Location:** `PaymentManager.java`  
- **How to find:** Use JADX to inspect `PaymentManager` or search for `STRIPE_KEY` / `PAYPAL_SECRET`.  
- **Exploit:** Extract the key and use it to test API requests in a safe environment.  
- **Risk:** Critical – allows unauthorized financial operations if abused.  
- **Fix:** Move API keys to a secure server or use Android Keystore.  

---

## 2. Hardcoded AWS Credentials (Critical)

- **Location:** `MainActivity.java` → `setupAWSCredentials()`  
- **How to find:** Inspect `SharedPreferences` for AWS keys.  
- **Exploit:** Access S3 buckets or cloud resources.  
- **Risk:** Critical – can compromise sensitive storage.  
- **Fix:** Use temporary credentials via AWS Cognito. Never store credentials in the app.  

---

## 3. Unencrypted SQLite storing PII (High)

- **Location:** `DatabaseHelper.java` → `quickpay.db`  
- **How to find:** Pull DB using `adb shell` or inspect local databases.  
- **Exploit:** Access sensitive user info (email, SSN, cards).  
- **Risk:** High.  
- **Fix:** Encrypt database using SQLCipher or equivalent.

---

## 4. Exported BroadcastReceiver (High)

- **Location:** `TransactionReceiver.java`  
- **Manifest:** `android:exported="true"` in `AndroidManifest.xml`  
- **Exploit:** Any app can send intents to trigger transactions without auth.  
- **Risk:** High.  
- **Fix:** Set `exported=false` or enforce proper permission checks.  

---

## 5. Weak PIN Encryption (Medium)

- **Location:** `PinManager.java` → `savePin()`  
- **Issue:** Base64 encoding is reversible.  
- **Risk:** Medium.  
- **Fix:** Use PBKDF2, bcrypt, or AES encryption with secure key storage.  

---

## 6. Certificate Pinning Bypass (Medium)

- **Location:** `NetworkManager.java`  
- **Issue:** Trusts all SSL certificates.  
- **Exploit:** MITM attack using Burp Suite or Frida.  
- **Risk:** Medium.  
- **Fix:** Implement proper certificate pinning and obfuscate logic.  

---

## 7. Debug Logs with Sensitive Info (Medium)

- **Location:** `MainActivity.java` → `Log.d(TAG, "User session initialized with token: ...")`  
- **Exploit:** Any connected device / ADB session can read logs.  
- **Risk:** Medium.  
- **Fix:** Remove debug logs in production or use `BuildConfig.DEBUG` checks.  

---

## 8. Insecure WebView Implementation (Low)

- **Location:** `MainActivity.java` → `setupWebView()`  
- **Issue:** `addJavascriptInterface()` exposes auth token to JS; JavaScript enabled on untrusted URLs.  
- **Risk:** Low (requires attacker-controlled content).  
- **Fix:** Disable JavaScript for untrusted URLs, enforce HTTPS, limit JS interface exposure.  

---

## Example Bug Bounty Report

- **Title:** Hardcoded Stripe API Key in QuickPay  
- **Description:** Stripe API key found in APK, can be abused to test API endpoints.  
- **Steps to Reproduce:**  
  1. Decompile APK using JADX.  
  2. Open `PaymentManager.java`.  
  3. Observe `STRIPE_KEY` constant.  
- **Impact:** Unauthorized access to API functions.  
- **CVSS Score:** 9.0  
- **Remediation:** Move keys to server-side storage. Use secure key storage.  
- **Attachments:** Screenshots, Frida commands, proof-of-concept scripts.  

---

> **Author:** Riya Nair  
> MSc Cybersecurity | Bug Bounty Researcher & Instructor  
> GitHub: [https://github.com/riyanair](https://github.com/riyanair)
